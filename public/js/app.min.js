"use strict";angular.module("oneImobiliaria",["ui.router","ui.utils.masks"]).run(["$rootScope","$state","RESOURCES","UserService",function(e,r,t,o){return e.error=!1,e.success=!1,e.loading=!1,e.fileUrl=t.API_URL+"/",e.page="",e.name="",e.showMenu=!1,e.showSubmenu=!1,e.appTitle="One Consultoria Imobiliária",e.forms={},e.doLogout=function(){return o.doLogout()},e.toggleMenu=function(){return e.showMenu=!e.showMenu},e.toggleSubmenu=function(){return e.showSubmenu=!e.showSubmenu},e.$on("$stateChangeSuccess",function(){var t;if(t=r.current.name.split("."),e.page=t[1]||"",e.name=localStorage.getItem("name-one")||"",e.error=!1,e.success=!1,e.loading=!1,e.showMenu=!1,e.showSubmenu=!1,r.current.requiredLogin&&!o.isLogged()&&o.doLogout(),!r.current.requiredLogin&&o.isLogged())return r.go("dashboard.home")})}]).constant("RESOURCES",{API_URL:"http://localhost:3000/api"}),angular.module("oneImobiliaria").config(["$stateProvider","$httpProvider","$urlRouterProvider",function(e,r,t){return e.state("login",{url:"/login",views:{main:{templateUrl:"app/views/login/index.html",controller:"LoginCtrl"},"error@login":{templateUrl:"app/views/error.html"}},requiredLogin:!1}).state("dashboard",{url:"/dashboard","abstract":!0,views:{main:{},header:{templateUrl:"app/views/header.html"},footer:{templateUrl:"app/views/footer.html"}},requiredLogin:!0}).state("dashboard.home",{url:"/home",views:{"main@":{templateUrl:"app/views/home/index.html"}},requiredLogin:!0}).state("dashboard.users",{url:"/users",views:{"main@":{templateUrl:"app/views/users/index.html",controller:"UsersCtrl"},"submenu@dashboard.users":{templateUrl:"app/views/users/submenu.html"},"error@dashboard.users":{templateUrl:"app/views/error.html"},"success@dashboard.users":{templateUrl:"app/views/success.html"},"loading@dashboard.users":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.users.new",{url:"/new",views:{"main@":{templateUrl:"app/views/users/form.html",controller:"UsersCtrl"},"error@dashboard.users.new":{templateUrl:"app/views/error.html"},"loading@dashboard.users.new":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.users.edit",{url:"/edit/:id",views:{"main@":{templateUrl:"app/views/users/form.html",controller:"UsersCtrl"},"error@dashboard.users.edit":{templateUrl:"app/views/error.html"},"loading@dashboard.users.edit":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.clients",{url:"/clients",views:{"main@":{templateUrl:"app/views/clients/index.html",controller:"ClientsCtrl"},"submenu@dashboard.clients":{templateUrl:"app/views/clients/submenu.html"},"error@dashboard.clients":{templateUrl:"app/views/error.html"},"success@dashboard.clients":{templateUrl:"app/views/success.html"},"loading@dashboard.clients":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.clients.new",{url:"/new",views:{"main@":{templateUrl:"app/views/clients/form.html",controller:"ClientsCtrl"},"error@dashboard.clients.new":{templateUrl:"app/views/error.html"},"loading@dashboard.clients.new":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.clients.edit",{url:"/edit/:id",views:{"main@":{templateUrl:"app/views/clients/form.html",controller:"ClientsCtrl"},"error@dashboard.clients.edit":{templateUrl:"app/views/error.html"},"loading@dashboard.users.edit":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.properties",{url:"/properties",views:{"main@":{templateUrl:"app/views/properties/index.html"},"submenu@dashboard.properties":{templateUrl:"app/views/properties/submenu.html"}},requiredLogin:!0}),t.otherwise("/login"),r.interceptors.push("sessionInjector"),r.defaults.useXDomain=!0,r.defaults.headers.common["Content-Type"]="application/json",delete r.defaults.headers.common["X-Requested-With"]}]),angular.module("oneImobiliaria").service("ClientService",["$http","$state","RESOURCES",function(e,r,t){var o;return o=t.API_URL+"/clients",{create:function(r){return e.post(o,r)},update:function(r){return e.put(o+"/"+r._id,r)},saveOrUpdate:function(e){return e._id?this.update(e):this.create(e)},getAll:function(){return e.get(o)},get:function(r){return e.get(o+"/"+r)},"delete":function(r){return e["delete"](o+"/"+r)}}}]),angular.module("oneImobiliaria").service("$loading",["$rootScope",function(e){return{show:function(){return e.loading=!0},hide:function(){return e.loading=!1}}}]),angular.module("oneImobiliaria").service("$logger",["$rootScope",function(e){return{clean:function(){return e.success=!1,e.error=!1,e.modalError=!1},error:function(r){return this.clean(),e.error=r},modalError:function(r){return this.clean(),e.modalError=r},success:function(r){return this.clean(),e.success=r}}}]),angular.module("oneImobiliaria").service("sessionInjector",["storage",function(e){var r;return r=function(e){return e.url.indexOf("auth")>-1||e.url.indexOf("remember")>-1},{request:function(t){return r(t)||(t.headers["x-access-token"]=e.getSessionToken()),t}}}]),angular.module("oneImobiliaria").service("storage",function(){return{isLogged:function(){return null!==localStorage.getItem("x-code-one")&&null!==localStorage.getItem("code-one")},setCodes:function(e){return localStorage.setItem("x-code-one",e.token),localStorage.setItem("code-one",e.code),localStorage.setItem("group-one",e.type),localStorage.setItem("name-one",e.name)},getSessionToken:function(){return localStorage.getItem("x-code-one")},getCode:function(){return localStorage.getItem("code-one")},clean:function(){return localStorage.removeItem("x-code-one"),localStorage.removeItem("code-one"),localStorage.removeItem("group-one"),localStorage.removeItem("name-one")}}}),angular.module("oneImobiliaria").service("UserGroupService",function(){var e;return e=[{title:"Administrador(a)",code:"admin"},{title:"Corretor(a)",code:"broker"}],{getAll:function(){return e}}}),angular.module("oneImobiliaria").service("UserService",["$http","$state","storage","RESOURCES",function(e,r,t,o){var n;return n=o.API_URL+"/accounts",{isLogged:function(){return t.isLogged()},doLogin:function(r){return e.post(n+"/auth",r)},doLogout:function(){t.clean(),r.go("login")},create:function(r){return e.post(n,r)},update:function(r){return e.put(n+"/"+r._id,r)},saveOrUpdate:function(e){return e._id?this.update(e):this.create(e)},getAll:function(){return e.get(n)},get:function(r){return e.get(n+"/"+r)},"delete":function(r){return e["delete"](n+"/"+r)}}}]),angular.module("oneImobiliaria").filter("dateBr",function(){return function(e){var r;return null==e?"":(r=e.split("T"),moment(r[0]).format("DD/MM/YYYY"))}}),angular.module("oneImobiliaria").filter("dateTimeBr",function(){return function(e){return null==e?"":(moment.locale("pt-br"),moment(e).calendar(null,{sameElse:"DD/MM/YYYY - H:mm"}))}}),angular.module("oneImobiliaria").filter("firstName",function(){return function(e){var r;return null==e||""===e?"":(r=e.split(" "),r[0])}}),angular.module("oneImobiliaria").filter("phoneBr",function(){return function(e){return null==e?"":10===e.length?e.replace(/(\d{2})(\d{4})(\d{4})/g,"($1) $2-$3"):e.replace(/(\d{2})(\d{5})(\d{4})/g,"($1) $2-$3")}}),angular.module("oneImobiliaria").filter("groupName",function(){return function(e){var r,t;return null==e||""===e?"":(r=[{title:"Administrador(a)",code:"admin"},{title:"Corretor(a)",code:"broker"}],t="",r.map(function(r){if(r.code===e)return t=r.title}),t)}}),angular.module("oneImobiliaria").directive("file",function(){return{require:"ngModel",restrict:"A",link:function(e,r,t,o){var n;return n=function(r){var t,n;return n=r.target.files,t=n[0],o.$setViewValue(t),e.$apply()},r.bind("change",n)}}}),angular.module("oneImobiliaria").controller("ClientsCtrl",["$scope","$rootScope","$state","$stateParams","$filter","$loading","$logger","storage","ClientService",function(e,r,t,o,n,i,a,l,s){return e.client={},e.clients=[],e.edit=!0,i.show(),o.id?s.get(o.id).then(function(r){return e.client=r.data,e.edit=!1,i.hide()})["catch"](function(e){return a.error("Erro ao buscar clientes. Por favor, atualize a página."),i.hide()}):s.getAll().then(function(r){return e.clients=n("orderBy")(r.data,"-created"),i.hide()})["catch"](function(e){return a.error("Erro ao buscar clientes. Por favor, atualize a página."),i.hide()}),e.canEdit=function(){return e.edit=!0},e.saveOrUpdate=function(){return r.forms.client.$valid?(i.show(),s.saveOrUpdate(e.client).then(function(e){return i.hide(),t.go("dashboard.clients")})["catch"](function(e){return a.error("Erro ao criar/editar cliente. Por favor, tente novamente."),i.hide()})):void a.error("Preencha todos os dados obrigatórios.")},e.doDelete=function(r){var t;return t=e.clients[r],t._id!==l.getCode()&&(i.show(),s["delete"](t._id).then(function(t){return a.success("Cliente excluído com sucesso!"),e.clients.splice(r,1),i.hide()})["catch"](function(e){return a.error("Erro ao excluir cliente. Por favor, tente novamente."),i.hide()}))}}]),angular.module("oneImobiliaria").controller("LoginCtrl",["$scope","$rootScope","$state","$logger","storage","UserService",function(e,r,t,o,n,i){return e.user={},e.doLogin=function(){return r.forms.login.$valid?(e.user.origin="admin",i.doLogin(e.user).then(function(e){return n.setCodes(e.data),t.go("dashboard.home")})["catch"](function(e){return o.error("Usuário e/ou senha inválido(s).")})):void o.error("Preencha todos os dados obrigatórios.")}}]),angular.module("oneImobiliaria").controller("UsersCtrl",["$scope","$rootScope","$state","$stateParams","$filter","$loading","$logger","storage","UserGroupService","UserService",function(e,r,t,o,n,i,a,l,s,u){return e.user={},e.users=[],e.groups=s.getAll(),e.edit=!0,i.show(),o.id?u.get(o.id).then(function(r){return e.user=r.data,e.edit=!1,i.hide()})["catch"](function(e){return a.error("Erro ao buscar usuários. Por favor, atualize a página."),i.hide()}):u.getAll().then(function(r){return e.users=n("orderBy")(r.data,"-created"),i.hide()})["catch"](function(e){return a.error("Erro ao buscar usuários. Por favor, atualize a página."),i.hide()}),e.canEdit=function(){return e.edit=!0},e.saveOrUpdate=function(){return r.forms.user.$valid?(i.show(),u.saveOrUpdate(e.user).then(function(e){return i.hide(),t.go("dashboard.users")})["catch"](function(e){return a.error("Erro ao criar/editar usuário. Por favor, tente novamente."),i.hide()})):void a.error("Preencha todos os dados obrigatórios.")},e.doDelete=function(r){var t;return t=e.users[r],t._id!==l.getCode()&&(i.show(),u["delete"](t._id).then(function(t){return a.success("Usuário excluído com sucesso!"),e.users.splice(r,1),i.hide()})["catch"](function(e){return a.error("Erro ao excluir usuário. Por favor, tente novamente."),i.hide()}))}}]);
//# sourceMappingURL=app.min.js.map
