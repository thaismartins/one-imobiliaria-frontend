"use strict";angular.module("oneImobiliaria",["ui.router","ui.utils.masks","ui.slider"]).run(["$rootScope","$state","RESOURCES","storage","UserService",function(e,r,t,o,n){return e.error=!1,e.success=!1,e.loading=!1,e.fileUrl=t.API_URL+"/files/",e.newProperties={},e.page="",e.name="",e.showMenu=!1,e.showSubmenu=!1,e.showModal=!1,e.appTitle="One Consultoria Imobiliária",e.forms={},e.doLogout=function(){return n.doLogout()},e.toggleModal=function(){return e.showModal=!e.showModal},e.toggleMenu=function(){return e.showMenu=!e.showMenu},e.toggleSubmenu=function(){return e.showSubmenu=!e.showSubmenu},e.$on("$stateChangeSuccess",function(){var t;if(t=r.current.name.split("."),e.page=t[1]||"",e.group=o.getGroup(),e.name=o.getName(),e.photo=o.getPhoto(),e.error=!1,e.success=!1,e.loading=!1,e.showMenu=!1,e.showSubmenu=!1,r.current.requiredLogin&&!n.isLogged()&&n.doLogout(),!r.current.requiredLogin&&n.isLogged()&&r.go("dashboard.home"),"users"===e.page&&"admin"!==e.group)return r.go("dashboard.home")})}]).constant("RESOURCES",{API_URL:"http://localhost:3000/api"}),angular.module("oneImobiliaria").config(["$stateProvider","$httpProvider","$urlRouterProvider",function(e,r,t){return e.state("login",{url:"/login",views:{main:{templateUrl:"app/views/login/index.html",controller:"LoginCtrl"},"error@login":{templateUrl:"app/views/error.html"}},requiredLogin:!1}).state("dashboard",{url:"/dashboard","abstract":!0,views:{main:{},header:{templateUrl:"app/views/header.html"},footer:{templateUrl:"app/views/footer.html"}},requiredLogin:!0}).state("dashboard.home",{url:"/home",views:{"main@":{templateUrl:"app/views/home/index.html"}},requiredLogin:!0}).state("dashboard.users",{url:"/users",views:{"main@":{templateUrl:"app/views/users/index.html",controller:"UsersCtrl"},"submenu@dashboard.users":{templateUrl:"app/views/users/submenu.html"},"error@dashboard.users":{templateUrl:"app/views/error.html"},"success@dashboard.users":{templateUrl:"app/views/success.html"},"loading@dashboard.users":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.users.new",{url:"/new",views:{"main@":{templateUrl:"app/views/users/form.html",controller:"UsersCtrl"},"submenu@dashboard.users.new":{templateUrl:"app/views/users/form-submenu.html"},"error@dashboard.users.new":{templateUrl:"app/views/error.html"},"loading@dashboard.users.new":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.users.edit",{url:"/edit/:id",views:{"main@":{templateUrl:"app/views/users/form.html",controller:"UsersCtrl"},"submenu@dashboard.users.edit":{templateUrl:"app/views/users/form-submenu.html"},"error@dashboard.users.edit":{templateUrl:"app/views/error.html"},"loading@dashboard.users.edit":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.clients",{url:"/clients",views:{"main@":{templateUrl:"app/views/clients/index.html",controller:"ClientsCtrl"},"submenu@dashboard.clients":{templateUrl:"app/views/clients/submenu.html"},"search@dashboard.clients":{templateUrl:"app/views/clients/search.html"},"error@dashboard.clients":{templateUrl:"app/views/error.html"},"success@dashboard.clients":{templateUrl:"app/views/success.html"},"loading@dashboard.clients":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.clients.new",{url:"/new",views:{"main@":{templateUrl:"app/views/clients/form.html",controller:"ClientsCtrl"},"error@dashboard.clients.new":{templateUrl:"app/views/error.html"},"loading@dashboard.clients.new":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.clients.edit",{url:"/edit/:id",views:{"main@":{templateUrl:"app/views/clients/form.html",controller:"ClientsCtrl"},"error@dashboard.clients.edit":{templateUrl:"app/views/error.html"},"loading@dashboard.users.edit":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.properties",{url:"/properties",views:{"main@":{templateUrl:"app/views/properties/index.html",controller:"PropertiesCtrl"},"submenu@dashboard.properties":{templateUrl:"app/views/properties/submenu.html"},"search@dashboard.properties":{templateUrl:"app/views/properties/search.html"},"error@dashboard.properties":{templateUrl:"app/views/error.html"},"success@dashboard.properties":{templateUrl:"app/views/success.html"},"loading@dashboard.properties":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.properties.new",{url:"/new",views:{"main@":{templateUrl:"app/views/properties/form.html",controller:"PropertiesCtrl"},"submenu@dashboard.properties.new":{templateUrl:"app/views/properties/form-submenu.html"},"property@dashboard.properties.new":{templateUrl:"app/views/properties/property.html"},"interest@dashboard.properties.new":{templateUrl:"app/views/properties/interest.html"},"error@dashboard.properties.new":{templateUrl:"app/views/error.html"},"loading@dashboard.properties.new":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.properties.edit",{url:"/edit/:id",views:{"main@":{templateUrl:"app/views/properties/form.html",controller:"PropertiesCtrl"},"submenu@dashboard.properties.edit":{templateUrl:"app/views/properties/form-submenu.html"},"property@dashboard.properties.edit":{templateUrl:"app/views/properties/property.html"},"interest@dashboard.properties.edit":{templateUrl:"app/views/properties/interest.html"},"error@dashboard.properties.edit":{templateUrl:"app/views/error.html"},"loading@dashboard.properties.edit":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.confirm",{url:"/confirm",views:{"main@":{templateUrl:"app/views/confirm/index.html",controller:"ConfirmCtrl"},"submenu@dashboard.confirm":{templateUrl:"app/views/confirm/submenu.html"},"modal@dashboard.properties.confirm":{templateUrl:"app/views/confirm/modal.html"},"error@dashboard.confirm":{templateUrl:"app/views/error.html"},"loading@dashboard.confirm":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.account",{url:"/account",views:{"main@":{templateUrl:"app/views/account/form.html",controller:"AccountCtrl"},"submenu@dashboard.account":{templateUrl:"app/views/account/form-submenu.html"},"error@dashboard.account":{templateUrl:"app/views/error.html"},"loading@dashboard.account":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}).state("dashboard.search",{url:"/search",views:{"main@":{templateUrl:"app/views/search/index.html",controller:"SearchCtrl"},"submenu@dashboard.search":{templateUrl:"app/views/search/submenu.html"},"submenu-filter@dashboard.search":{templateUrl:"app/views/search/submenu-filter.html"},"filters-interest@dashboard.search":{templateUrl:"app/views/search/filters-interest.html",controller:"AccountCtrl"},"filters-property@dashboard.search":{templateUrl:"app/views/search/filters-property.html",controller:"AccountCtrl"},"modal@dashboard.search":{templateUrl:"app/views/search/modal.html"},"error@dashboard.search":{templateUrl:"app/views/error.html"},"loading@dashboard.search":{templateUrl:"app/views/loading.html"}},requiredLogin:!0}),t.otherwise("/login"),r.interceptors.push("sessionInjector"),r.defaults.useXDomain=!0,r.defaults.headers.common["Content-Type"]="application/json",delete r.defaults.headers.common["X-Requested-With"]}]),angular.module("oneImobiliaria").service("ClientService",["$http","$state","RESOURCES",function(e,r,t){var o;return o=t.API_URL+"/clients",{create:function(r){return e.post(o,r)},update:function(r){return e.put(o+"/"+r._id,r)},saveOrUpdate:function(e){return e._id?this.update(e):this.create(e)},getAll:function(){return e.get(o)},get:function(r){return e.get(o+"/"+r)},"delete":function(r){return e["delete"](o+"/"+r)}}}]),angular.module("oneImobiliaria").service("$loading",["$rootScope",function(e){return{show:function(){return e.loading=!0},hide:function(){return e.loading=!1}}}]),angular.module("oneImobiliaria").service("LocationService",["$http","$state","RESOURCES",function(e,r,t){var o;return o=t.API_URL+"/cities",{getAll:function(){return e.get(o)},getAllStates:function(){return e.get(o+"/states")},getCitiesByState:function(r){return e.get(o+"/states/"+r)}}}]),angular.module("oneImobiliaria").service("$logger",["$rootScope",function(e){return{clean:function(){return e.success=!1,e.error=!1,e.modalError=!1},error:function(r){return this.clean(),e.error=r},modalError:function(r){return this.clean(),e.modalError=r},success:function(r){return this.clean(),e.success=r}}}]),angular.module("oneImobiliaria").service("PaymentTypeService",function(){var e;return e=[{title:"Financiamento",code:"financing"},{title:"Dinheiro",code:"money"},{title:"Outros",code:"others"}],{getAll:function(){return e}}}),angular.module("oneImobiliaria").service("PropertyTypeService",function(){var e;return e=[{title:"Apartamento",code:"apartament"},{title:"Casa",code:"house"},{title:"Terreno",code:"land"},{title:"Casa",code:"house"},{title:"Carro",code:"car"}],{getAll:function(){return e}}}),angular.module("oneImobiliaria").service("PropertyService",["$http","$state","RESOURCES","$httpParamSerializer",function(e,r,t,o){var n;return n=t.API_URL+"/properties",{create:function(r){return e.post(n,r)},update:function(r){return e.put(n+"/"+r._id,r)},saveOrUpdate:function(e){return e._id?this.update(e):this.create(e)},getAll:function(){return e.get(n)},get:function(r){return e.get(n+"/"+r)},"delete":function(r){return e["delete"](n+"/"+r)},search:function(r){return e.get(n+"/search?"+o(r))},importCsv:function(r){var t;return t=new FormData,t.append("csv",r),e.post(n+"/import/csv",t,{withCredentials:!1,headers:{"Content-Type":void 0},transformRequest:angular.identity})}}}]),angular.module("oneImobiliaria").service("sessionInjector",["storage","$injector",function(e,r){var t;return t=function(e){return e.url.indexOf("auth")>-1||e.url.indexOf("remember")>-1},{request:function(r){return t(r)||(r.headers["x-access-token"]=e.getSessionToken()),r},responseError:function(t){return"TokenExpiredError"===t.data.error.name&&(e.clean(),r.get("$state").go("login")),t}}}]),angular.module("oneImobiliaria").service("storage",function(){return{isLogged:function(){return null!==localStorage.getItem("x-code-one")&&null!==localStorage.getItem("code-one")},setCodes:function(e){return localStorage.setItem("x-code-one",e.token),localStorage.setItem("code-one",e.code),localStorage.setItem("group-one",e.type),localStorage.setItem("name-one",e.name),localStorage.setItem("photo-one",e.photo)},setPhoto:function(e){return localStorage.setItem("photo-one",e)},updateToken:function(e){return localStorage.setItem("x-code-one",e)},getSessionToken:function(){return localStorage.getItem("x-code-one")},getCode:function(){return localStorage.getItem("code-one")},getName:function(){return localStorage.getItem("name-one")||""},getGroup:function(){return localStorage.getItem("group-one")||""},getPhoto:function(){return"undefined"!==localStorage.getItem("photo-one")&&localStorage.getItem("photo-one")},clean:function(){return localStorage.removeItem("x-code-one"),localStorage.removeItem("code-one"),localStorage.removeItem("group-one"),localStorage.removeItem("name-one")}}}),angular.module("oneImobiliaria").service("UserGroupService",function(){var e;return e=[{title:"Administrador(a)",code:"admin"},{title:"Corretor(a)",code:"broker"}],{getAll:function(){return e}}}),angular.module("oneImobiliaria").service("UserService",["$http","$q","$state","storage","RESOURCES",function(e,r,t,o,n){var i;return i=n.API_URL+"/accounts",{isLogged:function(){return o.isLogged()},doLogin:function(r){return e.post(i+"/auth",r)},doLogout:function(){o.clean(),t.go("login")},create:function(r){return e.post(i,r)},update:function(r){return e.put(i+"/"+r._id,r)},savePhoto:function(t){var o,n;return n=r.defer(),null==t||null==t.name?n.resolve({data:{file:null}}):(o=new FormData,o.append("photo",t),e.post(i+"/photo",o,{withCredentials:!1,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(e){return n.resolve(e)})["catch"](function(e){return n.reject(e)})),n.promise},saveOrUpdate:function(e){return e._id?this.update(e):this.create(e)},getAll:function(){return e.get(i)},get:function(r){return e.get(i+"/"+r)},getMyAccount:function(){return e.get(i+"/"+o.getCode())},"delete":function(r){return e["delete"](i+"/"+r)}}}]),angular.module("oneImobiliaria").filter("address",function(){return function(e){var r;return null==e||null==e.street&&null==e.number&&null==e.complement?"Indefinido":(r="",null!=e.street&&(r+=e.street),null!=e.number&&(r+=", "+e.number),null!=e.complement&&(r+=" - "+e.complement),null!=e.condominium&&(r+=" - "+e.condominium),r)}}),angular.module("oneImobiliaria").filter("dateBr",function(){return function(e){var r;return null==e?"":(r=e.split("T"),moment(r[0]).format("DD/MM/YYYY"))}}),angular.module("oneImobiliaria").filter("dateTimeBr",function(){return function(e){return null==e?"":(moment.locale("pt-br"),moment(e).calendar(null,{sameElse:"DD/MM/YYYY - H:mm"}))}}),angular.module("oneImobiliaria").filter("decimals",function(){return function(e){return null==e?"":e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}}),angular.module("oneImobiliaria").filter("errorImport",function(){return function(e,r){var t;switch(t="",e){case 1:t="Este cliente já possui um imóvel cadastrado.";break;case 5:t="Erro(s) no(s) campo(s) de cliente: "+r+".";break;case 6:t="Erro(s) no(s) campo(s) de imóvel: "+r+".";break;default:t="Erro ao salvar item. Por favor, verifique o dados inseridos na tabela."}return t}}),angular.module("oneImobiliaria").filter("firstName",function(){return function(e){var r;return null==e||""===e?"":(r=e.split(" "),r[0])}}),angular.module("oneImobiliaria").filter("fullAddress",function(){return function(e){var r;return null==e||null==e.street&&null==e.number&&null==e.complement?"Indefinido":(r="",null!=e.street&&(r+=e.street),null!=e.number&&(r+=", "+e.number),null!=e.complement&&(r+=" - "+e.complement),null!=e.condominium&&(r+=" - "+e.condominium),null!=e.city&&(r+=" - "+e.city),null!=e.state&&(r+="/"+e.state),r)}}),angular.module("oneImobiliaria").filter("meters",function(){return function(e){return null!=e&&""!==e||(e="0"),e+" m²"}}),angular.module("oneImobiliaria").filter("orderByString",function(){return function(e,r,t){var o;return o=e.sort(function(e,t){return angular.isUndefined(r)&&e.localeCompare(t),e[r].localeCompare(t[r])}),t?o.reverse():o}}),angular.module("oneImobiliaria").filter("paymentType",["PaymentTypeService",function(e){return function(r){var t,o,n;return null==r||""===r||0===r.length?"":(o=e.getAll(),t=function(e){var r;return r="",o.map(function(t){if(t.code===e)return r=t.title}),r},n=[],r.map(function(e){var r;if((null!=e||""===e)&&(r=t(e),""!==r))return n.push(r)}),n.join(" | "))}}]),angular.module("oneImobiliaria").filter("phoneBr",function(){return function(e){return null==e?"":(e=e.replace(/[^0-9]/g,""),e.length<11?e.replace(/(\d{2})(\d{4})(\d{4})/g,"($1) $2-$3"):e.replace(/(\d{2})(\d{5})(\d{4})/g,"($1) $2-$3"))}}),angular.module("oneImobiliaria").filter("propertyType",["PropertyTypeService",function(e){return function(r){var t,o;return null==r||""===r?"":(t=e.getAll(),o="",t.map(function(e){if(e.code===r)return o=e.title}),o)}}]),angular.module("oneImobiliaria").filter("range",function(){return function(e){var r,t,o,n;for(n=[],r=t=1,o=e+1;t<o;r=t+=1)n.push(r);return n}}),angular.module("oneImobiliaria").filter("typesToText",function(){return function(e){var r,t,o,n,i;if(!(null!=e&&e.length>0))return"Indefinido";for(t={apart:"Apartamento",land:"Tereno",car:"Carro",house:"Case"},i=[],r=0,o=e.length;r<o;r++)n=e[r],i.push(t[n]);return i.join(" | ")}}),angular.module("oneImobiliaria").filter("groupName",["UserGroupService",function(e){return function(r){var t,o;return null==r||""===r?"":(t=e.getAll(),o="",t.map(function(e){if(e.code===r)return o=e.title}),o)}}]),angular.module("oneImobiliaria").filter("yesOrNo",function(){return function(e){return e?"Sim":"Não"}}),angular.module("oneImobiliaria").directive("ngConfirmClick",function(){return{priority:-1,restrict:"A",link:function(e,r,t){var o;return o=t.ngConfirmClick,r.bind("click",function(e){if(null!=o&&!confirm(o))return e.stopImmediatePropagation(),e.preventDefault()})}}}),angular.module("oneImobiliaria").directive("decimals",["$parse",function(e){return{require:"?ngModel",scope:{ngModel:"="},restrict:"A",link:function(r,t,o,n){var i,l;return l=function(e){return null==e?"":e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")},n.$formatters.push(function(e){return l(e)}),n.$parsers.push(function(e){return l(e)}),i=function(){var t;return t=l(n.$modelValue),e(o.ngModel).assign(r,t),n.$viewValue=t,n.$render()},t.bind("keyup",i)}}}]),angular.module("oneImobiliaria").directive("file",["$parse","$timeout",function(e,r){return{require:"ngModel",restrict:"A",link:function(t,o,n,i){var l;return l=function(o){var l,a,s,u;return s=o.target.files,l=s[0],"undefined"==typeof n.ngFileSelected?(a=new FileReader,a.readAsDataURL(l),a.onload=function(e){return l.thumbnail=e.target.result,i.$setViewValue(l),t.$apply()}):(u=e(n.ngFileSelected),r(function(){return u(t,{$file:l,$event:o})}))},o.bind("change",l)}}}]),angular.module("oneImobiliaria").directive("meters",["$parse",function(e){return{require:"?ngModel",scope:{ngModel:"="},restrict:"A",link:function(r,t,o,n){var i,l;return console.log(n.$modelValue),l=function(e){return null==e&&(e=0),e=e.toString().replace("m²",""),e=e.toString().replace(/\D/g,""),e+"m²"},n.$formatters.push(function(e){return console.log(e),l(e)}),n.$parsers.push(function(e){return e.toString().replace("m²","")}),i=function(){var t;return t=l(n.$modelValue),console.log(t),e(o.ngModel).assign(r,t),n.$viewValue=t,n.$render()},t.bind("keyup",i)}}}]),angular.module("oneImobiliaria").controller("AccountCtrl",["$scope","$rootScope","$loading","$logger","storage","UserService",function(e,r,t,o,n,i){return e.user={},e.edit=!1,e.file={},e.fileName="Selecione um arquivo",t.show(),i.getMyAccount().then(function(r){return e.user=r.data,null==e.user.photo&&(e.user.photo=!1),t.hide()})["catch"](function(e){return o.error("Erro ao buscar sua conta. Por favor, atualize a página."),t.hide()}),e.canEdit=function(){return e.edit=!0},e.selectPhoto=function(){return null==e.file.name?(e.file={},e.fileName="Selecione um arquivo",!1):e.fileName=e.file.name},e.doUpdate=function(){return r.forms.user.$valid?(t.show(),i.savePhoto(e.file).then(function(r){return null!=r.data.file&&(e.user.photo=r.data.file,n.setPhoto(r.data.file)),i.update(e.user)}).then(function(e){return o.success("Sua conta foi atualizada com sucesso!"),n.updateToken(e.data.token),t.hide()})["catch"](function(e){return console.log(e),o.error("Erro ao editar sua conta. Por favor, tente novamente."),t.hide()})):void o.error("Preencha todos os dados obrigatórios.")}}]),angular.module("oneImobiliaria").controller("ClientsCtrl",["$scope","$rootScope","$state","$stateParams","$filter","$loading","$logger","storage","ClientService",function(e,r,t,o,n,i,l,a,s){return e.client={},e.clients=[],e.search={},e.edit=!0,i.show(),o.id?s.get(o.id).then(function(r){return e.client=r.data,e.edit=!1,i.hide()})["catch"](function(e){return l.error("Erro ao buscar clientes. Por favor, atualize a página."),i.hide()}):s.getAll().then(function(r){return e.clients=n("orderBy")(r.data,"-created"),i.hide()})["catch"](function(e){return l.error("Erro ao buscar clientes. Por favor, atualize a página."),i.hide()}),e.canEdit=function(){return e.edit=!0},e.saveOrUpdate=function(){return r.forms.client.$valid?(i.show(),s.saveOrUpdate(e.client).then(function(e){return i.hide(),t.go("dashboard.clients")})["catch"](function(e){return l.error("Erro ao criar/editar cliente. Por favor, tente novamente."),i.hide()})):void l.error("Preencha todos os dados obrigatórios.")},e.doDelete=function(r){var t;return t=e.clients[r],t._id!==a.getCode()&&(i.show(),s["delete"](t._id).then(function(t){return l.success("Cliente excluído com sucesso!"),e.clients.splice(r,1),i.hide()})["catch"](function(e){return l.error("Erro ao excluir cliente. Por favor, tente novamente."),i.hide()}))}}]),angular.module("oneImobiliaria").controller("ConfirmCtrl",["$scope","$rootScope","$q","$state","$filter","$loading","$logger","storage","PropertyService","LocationService","ClientService",function(e,r,t,o,n,i,l,a,s,u,p,c){var d,m,y,f;return e.properties=[],e.cities=[],e.states=[],e.clients=[],e.search={},d=[],e.edit=!0,l.show(),p.getAllStates().then(function(r){return e.states=r.data.sort(),c.getAll()}).then(function(r){return e.clients=i("orderByString")(r.data,"name"),l.hide()})["catch"](function(e){return a.error("Erro ao buscar imóveis. Por favor, atualize a página."),l.hide()}),e.showCities=function(r){return null!=d[r]?(e.cities=d[r],!1):(l.show(),p.getCitiesByState(r).then(function(t){var o;return o=i("orderByString")(t.data,"name"),e.cities=o,d[r]=o,l.hide()})["catch"](function(){return l.hide()}))},e.doEditCsv=function(t){var o,n;return o=e.newProperties.errors[t],e.property=o.property,e.property.client=o.client._id,null!=(null!=(n=e.property.address)?n.cep:void 0)&&(e.property.address.cep=e.property.address.cep.replace(/[^0-9.]/g,"")),delete e.property._id,r.toggleModal()},e.doTryAgain=function(r){var t,o;return t=e.newProperties.errors[r],o=t.property,o.client=t.client._id,delete o._id,e.property=o,f().then(function(){return e.newProperties.errors.splice(r,1)})},e.saveOrUpdateModal=function(t){return r.forms.property.$valid?f().then(function(){return e.newProperties.errors.splice(t,1),r.toggleModal()}):void a.error("Preencha todos os dados obrigatórios.")},e.doRemoveCsv=function(r){return e.newProperties.errors.splice(r,1)},f=function(){var r;return null!=e.property&&(r=t.defer(),l.show(),y(),u.saveOrUpdate(e.property).then(function(e){return l.hide(),r.resolve()})["catch"](function(e){return r.reject(),8===e.data.code?a.error("Verifique o endereço digitado. Não foi possível validar esta informação."):a.error("Erro ao criar/editar imóvel. Por favor, tente novamente."),l.hide()}))},m=function(){var r,t,o,n,i,l,a;if(e.property.interest.allMeters=[10,500],e.property.interest.allVacancies=[0,50],e.property.interest.allFloors=[1,30],e.property.interest.allValues=[1e3,5e6],e.property.interest.allIptus=[1e3,15e3],e.property.interest.allCondominiums=[1e3,5e5],e.property.interest.allLocations=[1e3,5e4],null!=(null!=(r=e.property.interest)?r.meters:void 0)&&(e.property.interest.allMeters[0]=e.property.interest.meters.min,e.property.interest.allMeters[1]=e.property.interest.meters.max),null!=(null!=(t=e.property.interest)?t.condominium:void 0)&&(e.property.interest.allCondominiums[0]=e.property.interest.condominium.min,e.property.interest.allCondominiums[1]=e.property.interest.condominium.max),null!=(null!=(o=e.property.interest)?o.vacancy:void 0)&&(e.property.interest.allVacancies[0]=e.property.interest.vacancy.min,e.property.interest.allVacancies[1]=e.property.interest.vacancy.max),null!=(null!=(n=e.property.interest)?n.floor:void 0)&&(e.property.interest.allFloors[0]=e.property.interest.floor.min,e.property.interest.allFloors[1]=e.property.interest.floor.max),null!=(null!=(i=e.property.interest)?i.value:void 0)&&(e.property.interest.allValues[0]=e.property.interest.value.min,e.property.interest.allValues[1]=e.property.interest.value.max),null!=(null!=(l=e.property.interest)?l.iptu:void 0)&&(e.property.interest.allIptus[0]=e.property.interest.iptu.min,e.property.interest.allIptus[1]=e.property.interest.iptu.max),null!=(null!=(a=e.property.interest)?a.location:void 0))return e.property.interest.allLocations[0]=e.property.interest.location.min,e.property.interest.allLocations[1]=e.property.interest.location.max},y=function(){if(e.property.value=e.property.value.toFixed(2),e.property.condominium=e.property.condominium.toFixed(2),e.property.location=e.property.location.toFixed(2),e.property.iptu=e.property.iptu.toFixed(2),null!=e.property.interest.allMeters&&(e.property.interest.meters={min:e.property.interest.allMeters[0],max:e.property.interest.allMeters[1]},delete e.property.interest.allMeters),null!=e.property.interest.allCondominiums&&(e.property.interest.condominium={min:e.property.interest.allCondominiums[0],max:e.property.interest.allCondominiums[1]},delete e.property.interest.allCondominiums),null!=e.property.interest.allVacancies&&(e.property.interest.vacancy={min:e.property.interest.allVacancies[0],max:e.property.interest.allVacancies[1]},delete e.property.interest.allVacancies),null!=e.property.interest.allFloors&&(e.property.interest.floor={min:e.property.interest.allFloors[0],max:e.property.interest.allFloors[1]},delete e.property.interest.allFloors),null!=e.property.interest.allValues&&(e.property.interest.value={min:e.property.interest.allValues[0],max:e.property.interest.allValues[1]},delete e.property.interest.allValues),null!=e.property.interest.allIptus&&(e.property.interest.iptu={min:e.property.interest.allIptus[0],max:e.property.interest.allIptus[1]},delete e.property.interest.allIptus),null!=e.property.interest.allLocations)return e.property.interest.location={min:e.property.interest.allLocations[0],max:e.property.interest.allLocations[1]},delete e.property.interest.allLocations}}]),angular.module("oneImobiliaria").controller("LoginCtrl",["$scope","$rootScope","$state","$logger","storage","UserService",function(e,r,t,o,n,i){return e.user={},e.doLogin=function(){return r.forms.login.$valid?(e.user.origin="admin",i.doLogin(e.user).then(function(e){return n.setCodes(e.data),t.go("dashboard.home")})["catch"](function(e){return o.error("Usuário e/ou senha inválido(s).")})):void o.error("Preencha todos os dados obrigatórios.")}}]),angular.module("oneImobiliaria").controller("PropertiesCtrl",["$scope","$rootScope","$q","$state","$stateParams","$filter","$loading","$logger","storage","PropertyService","LocationService","ClientService",function(e,r,t,o,n,i,l,a,s,u,p,c){var d,m,y;return e.properties=[],e.cities=[],e.states=[],e.clients=[],e.search={},d=[],e.edit=!0,e.property={code:123,value:5e5,address:{street:"Rua Simões Delgado",number:15,neighborhood:"Jardim Nove de Julho",condominium:"Condominio de Teste"}},l.show(),n.id?u.get(n.id).then(function(r){return e.property=r.data,m(),p.getAllStates()}).then(function(r){return e.states=r.data.sort(),p.getCitiesByState(e.property.address.state)}).then(function(r){var t;return t=i("orderByString")(r.data,"name"),e.cities=t,d[e.property.address.state]=t,c.getAll()}).then(function(r){return e.clients=i("orderByString")(r.data,"name"),e.edit=!1,l.hide()})["catch"](function(e){return a.error("Erro ao buscar imóveis. Por favor, atualize a página."),l.hide()}):u.getAll().then(function(r){return e.properties=i("orderBy")(r.data,"-created"),m(),p.getAllStates()}).then(function(r){return e.states=r.data.sort(),c.getAll()}).then(function(r){return e.clients=i("orderByString")(r.data,"name"),l.hide()})["catch"](function(e){return a.error("Erro ao buscar imóveis. Por favor, atualize a página."),l.hide()}),e.showCities=function(r){return null!=d[r]?(e.cities=d[r],!1):(l.show(),p.getCitiesByState(r).then(function(t){var o;return o=i("orderByString")(t.data,"name"),e.cities=o,d[r]=o,l.hide()})["catch"](function(){return l.hide()}))},e.canEdit=function(){return e.edit=!0},e.saveOrUpdate=function(){return r.forms.property.$valid&&null!=e.property?(l.show(),y(),u.saveOrUpdate(e.property).then(function(e){return l.hide(),o.go("dashboard.properties")})["catch"](function(e){return 8===e.data.code?a.error("Verifique o endereço digitado. Não foi possível validar esta informação."):a.error("Erro ao criar/editar imóvel. Por favor, tente novamente."),l.hide()})):void a.error("Preencha todos os dados obrigatórios.")},e.doDelete=function(r){var t;return t=e.properties[r],t._id!==s.getCode()&&(l.show(),u["delete"](t._id).then(function(t){return a.success("Imóvel excluído com sucesso!"),e.properties.splice(r,1),l.hide()})["catch"](function(e){return a.error("Erro ao excluir imóvel. Por favor, tente novamente."),l.hide()}))},e.doUploadCSV=function(t){return null==t||"text/csv"!==t.type?(a.error("Por favor, selecione um arquivo válido do tipo .csv"),!1):(r.newProperties={},l.show(),u.importCsv(t).then(function(t){return e.file=null,r.newProperties=t.data.content,o.go("dashboard.properties.confirm"),l.hide()})["catch"](function(r){return e.file={},a.error("Erro ao importar dados. Por favor, tente novamente."),l.hide()}))},m=function(){var r,t,o,n,i,l,a;if(null==e.property.interest&&(e.property.interest={}),e.property.interest.allMeters=[10,500],e.property.interest.allVacancies=[0,50],e.property.interest.allFloors=[1,30],e.property.interest.allValues=[1e3,5e6],e.property.interest.allIptus=[1e3,15e3],e.property.interest.allCondominiums=[1e3,5e5],e.property.interest.allLocations=[1e3,5e4],null!=(null!=(r=e.property.interest)?r.meters:void 0)&&(e.property.interest.allMeters[0]=e.property.interest.meters.min,e.property.interest.allMeters[1]=e.property.interest.meters.max),null!=(null!=(t=e.property.interest)?t.condominium:void 0)&&(e.property.interest.allCondominiums[0]=e.property.interest.condominium.min,e.property.interest.allCondominiums[1]=e.property.interest.condominium.max),null!=(null!=(o=e.property.interest)?o.vacancy:void 0)&&(e.property.interest.allVacancies[0]=e.property.interest.vacancy.min,e.property.interest.allVacancies[1]=e.property.interest.vacancy.max),null!=(null!=(n=e.property.interest)?n.floor:void 0)&&(e.property.interest.allFloors[0]=e.property.interest.floor.min,e.property.interest.allFloors[1]=e.property.interest.floor.max),null!=(null!=(i=e.property.interest)?i.value:void 0)&&(e.property.interest.allValues[0]=e.property.interest.value.min,e.property.interest.allValues[1]=e.property.interest.value.max),null!=(null!=(l=e.property.interest)?l.iptu:void 0)&&(e.property.interest.allIptus[0]=e.property.interest.iptu.min,e.property.interest.allIptus[1]=e.property.interest.iptu.max),null!=(null!=(a=e.property.interest)?a.location:void 0))return e.property.interest.allLocations[0]=e.property.interest.location.min,e.property.interest.allLocations[1]=e.property.interest.location.max},y=function(){return e.property.value=e.property.value.toFixed(2),null!=e.property.condominium&&(e.property.condominium=e.property.condominium.toFixed(2)),null!=e.property.location&&(e.property.location=e.property.location.toFixed(2)),null!=e.property.iptu&&(e.property.iptu=e.property.iptu.toFixed(2)),null!=e.property.interest&&(null!=e.property.interest.allMeters&&(e.property.interest.meters={min:e.property.interest.allMeters[0],max:e.property.interest.allMeters[1]},delete e.property.interest.allMeters),null!=e.property.interest.allCondominiums&&(e.property.interest.condominium={min:e.property.interest.allCondominiums[0],max:e.property.interest.allCondominiums[1]},delete e.property.interest.allCondominiums),null!=e.property.interest.allVacancies&&(e.property.interest.vacancy={min:e.property.interest.allVacancies[0],max:e.property.interest.allVacancies[1]},delete e.property.interest.allVacancies),null!=e.property.interest.allFloors&&(e.property.interest.floor={min:e.property.interest.allFloors[0],max:e.property.interest.allFloors[1]},delete e.property.interest.allFloors),null!=e.property.interest.allValues&&(e.property.interest.value={min:e.property.interest.allValues[0],max:e.property.interest.allValues[1]},delete e.property.interest.allValues),null!=e.property.interest.allIptus&&(e.property.interest.iptu={min:e.property.interest.allIptus[0],max:e.property.interest.allIptus[1]},delete e.property.interest.allIptus),null!=e.property.interest.allLocations?(e.property.interest.location={min:e.property.interest.allLocations[0],max:e.property.interest.allLocations[1]},delete e.property.interest.allLocations):void 0)}}]),angular.module("oneImobiliaria").controller("SearchCtrl",["$scope","$rootScope","$loading","$logger","storage","PropertyService",function(e,r,t,o,n,i){var l,a,s,u;return e.properties=[],e.showFilters=!1,e.property={},e.interest={},e.query={interest:{},property:{}},s=function(){
return e.query.interest.allMeters=[0,500],e.query.interest.allVacancies=[0,50],e.query.interest.allFloors=[0,30],e.query.interest.allValues=[0,5e6],e.query.interest.allIptus=[0,15e3],e.query.interest.allCondominiums=[0,5e5],e.query.interest.allLocations=[0,5e4],e.query.property.allMeters=[0,500],e.query.property.allVacancies=[0,50],e.query.property.allFloors=[0,30],e.query.property.allValues=[0,5e6],e.query.property.allIptus=[0,15e3],e.query.property.allCondominiums=[0,5e5],e.query.property.allLocations=[0,5e4]},u=function(){if(s(),null!=e.property.interest.types&&(e.property.interest.types=[]),null!=e.property.interest.meters&&(e.property.interest.allMeters[0]=e.property.interest.meters.min,e.property.interest.allMeters[1]=e.property.interest.meters.max),null!=e.property.interest.condominium&&(e.property.interest.allCondominiums[0]=e.property.interest.condominium.min,e.property.interest.allCondominiums[1]=e.property.interest.condominium.max),null!=e.property.interest.vacancy&&(e.property.interest.allVacancies[0]=e.property.interest.vacancy.min,e.property.interest.allVacancies[1]=e.property.interest.vacancy.max),null!=e.property.interest.floor&&(e.property.interest.allFloors[0]=e.property.interest.floor.min,e.property.interest.allFloors[1]=e.property.interest.floor.max),null!=e.property.interest.value&&(e.property.interest.allValues[0]=e.property.interest.value.min,e.property.interest.allValues[1]=e.property.interest.value.max),null!=e.property.interest.iptu&&(e.property.interest.allIptus[0]=e.property.interest.iptu.min,e.property.interest.allIptus[1]=e.property.interest.iptu.max),null!=e.property.interest.location)return e.property.interest.allLocations[0]=e.property.interest.location.min,e.property.interest.allLocations[1]=e.property.interest.location.max},l=function(){if(null!=e.query.property.allMeters&&(e.query.property.meters={min:e.query.property.allMeters[0],max:e.query.property.allMeters[1]},delete e.query.property.allMeters),null!=e.query.property.allCondominiums&&(e.query.property.condominium={min:e.query.property.allCondominiums[0],max:e.query.property.allCondominiums[1]},delete e.query.property.allCondominiums),null!=e.query.property.allVacancies&&(e.query.property.vacancy={min:e.query.property.allVacancies[0],max:e.query.property.allVacancies[1]},delete e.query.property.allVacancies),null!=e.query.property.allFloors&&(e.query.property.floor={min:e.query.property.allFloors[0],max:e.query.property.allFloors[1]},delete e.query.property.allFloors),null!=e.query.property.allValues&&(e.query.property.value={min:e.query.property.allValues[0],max:e.query.property.allValues[1]},delete e.query.property.allValues),null!=e.query.property.allIptus&&(e.query.property.iptu={min:e.query.property.allIptus[0],max:e.query.property.allIptus[1]},delete e.query.property.allIptus),null!=e.query.property.allLocations&&(e.query.property.location={min:e.query.property.allLocations[0],max:e.query.property.allLocations[1]},delete e.query.property.allLocations),null!=e.query.interest.allMeters&&(e.query.interest.meters={min:e.query.interest.allMeters[0],max:e.query.interest.allMeters[1]},delete e.query.interest.allMeters),null!=e.query.interest.allCondominiums&&(e.query.interest.condominium={min:e.query.interest.allCondominiums[0],max:e.query.interest.allCondominiums[1]},delete e.query.interest.allCondominiums),null!=e.query.interest.allVacancies&&(e.query.interest.vacancy={min:e.query.interest.allVacancies[0],max:e.query.interest.allVacancies[1]},delete e.query.interest.allVacancies),null!=e.query.interest.allFloors&&(e.query.interest.floor={min:e.query.interest.allFloors[0],max:e.query.interest.allFloors[1]},delete e.query.interest.allFloors),null!=e.query.interest.allValues&&(e.query.interest.value={min:e.query.interest.allValues[0],max:e.query.interest.allValues[1]},delete e.query.interest.allValues),null!=e.query.interest.allIptus&&(e.query.interest.iptu={min:e.query.interest.allIptus[0],max:e.query.interest.allIptus[1]},delete e.query.interest.allIptus),null!=e.query.interest.allLocations)return e.query.interest.location={min:e.query.interest.allLocations[0],max:e.query.interest.allLocations[1]},delete e.query.interest.allLocations},e.toggleFilters=function(){if(e.showFilters=!e.showFilters,!e.showFilters)return s()},e.doFilter=function(){return t.show(),l(),a()},e.showDetails=function(t){if(null!=t)return e.property=t.property,e.interest=t.interest,r.toggleModal()},(a=function(){return i.search(e.query).then(function(r){return e.properties=r.data,e.showFilters=!1,t.hide()})["catch"](function(e){return o.error("Erro ao efetuar busca. Por favor, tente novamente."),t.hide()})})()}]),angular.module("oneImobiliaria").controller("UsersCtrl",["$scope","$rootScope","$state","$stateParams","$filter","$loading","$logger","storage","UserGroupService","UserService",function(e,r,t,o,n,i,l,a,s,u){return e.user={},e.users=[],e.file={},e.fileName="Selecione um arquivo",e.groups=s.getAll(),e.edit=!0,i.show(),o.id?u.get(o.id).then(function(r){return e.user=r.data,null==e.user.photo&&(e.user.photo=!1),e.edit=!1,i.hide()})["catch"](function(e){return l.error("Erro ao buscar usuários. Por favor, atualize a página."),i.hide()}):u.getAll().then(function(r){return e.users=n("orderBy")(r.data,"-created"),i.hide()})["catch"](function(e){return l.error("Erro ao buscar usuários. Por favor, atualize a página."),i.hide()}),e.canEdit=function(){return e.edit=!0},e.selectPhoto=function(){return null==e.file.name?(e.file={},e.fileName="Selecione um arquivo",!1):e.fileName=e.file.name},e.saveOrUpdate=function(){return r.forms.user.$valid?(i.show(),u.savePhoto(e.file).then(function(r){return null!=r.data.file&&(e.user.photo=r.data.file),u.saveOrUpdate(e.user)}).then(function(e){return i.hide(),t.go("dashboard.users")})["catch"](function(e){return l.error("Erro ao criar/editar usuário. Por favor, tente novamente."),i.hide()})):void l.error("Preencha todos os dados obrigatórios.")},e.doDelete=function(r){var t;return t=e.users[r],t._id!==a.getCode()&&(i.show(),u["delete"](t._id).then(function(t){return l.success("Usuário excluído com sucesso!"),e.users.splice(r,1),i.hide()})["catch"](function(e){return l.error("Erro ao excluir usuário. Por favor, tente novamente."),i.hide()}))}}]);
//# sourceMappingURL=app.min.js.map
